
🛠 Claude Debug 行为规范（Debug Rules for Claude）

✅ 文档目标

本规范旨在约束 Claude 在调试（debug）时的行为，防止其：
	1.	自以为是地判断 bug 原因导致错误诊断；
	2.	私自修改稳定功能，引入新 bug；
	3.	忘记当前调试上下文，重复工作或逻辑混乱。

⚠️ 三大高频问题（必须避免）

问题编号	描述	严重性
P1	Claude调试时总是自以为找到了关键问题，结果往往完全错判，浪费大量尝试	🚨极高
P2	Claude调试时悄悄动了不该动的地方，造成新功能崩溃或逻辑串联错误	🚨极高
P3	Claude因上下文丢失，调试逻辑经常中断或自相矛盾，令人困惑	⚠️严重


⸻

🧭 Claude Debug 流程要求（Step-by-Step）

🥇 第一步：确认问题
	•	❌ 禁止凭直觉随意猜测问题原因；
	•	✅ 必须逐步收集错误信息，例如日志、traceback、异常内容；
	•	✅ 建议 Claude 用表格或分点方式输出错误现象、可能原因、关联模块。

🥈 第二步：模拟复现
	•	❌ 禁止“没跑过就自信地修改”；
	•	✅ 必须先定位复现路径：运行哪段脚本 / 输入什么条件 / 哪个配置；
	•	✅ 记录复现条件供后续引用。

🥉 第三步：列出候选原因
	•	✅ Claude 应输出一个 “可能出错原因清单”，每一条都写明：
	•	涉及模块/函数/变量；
	•	是否与最近改动有关；
	•	是否影响其他模块。
✅ 示例格式：

🔍 疑似出错点清单：
1. `audio_player.py:load_audio()` 函数中可能未检查 URL 是否为空；
2. `config.yaml` 中 `api_key` 可能未传入；



⸻

🔐 Debug 修改规范

🚫 禁止私自修改稳定模块
	•	如果不是本次调试目标的模块，Claude禁止修改！
	•	任何改动必须写入协作日志（见 claude_workspace）

✅ 所有修改必须满足以下条件：

规则	内容
🔍 透明修改	所有修改必须写清楚“为什么改”、“改了哪里”、“是否测试通过”
🧪 可回滚	若修改失败，Claude必须保证可撤销（建议保留原逻辑为注释）
📋 更新文档	若修改影响结构/接口，必须同步更新 config 或接口说明


⸻

🧠 Claude 记忆控制建议（防上下文丢失）
	1.	在多轮调试中，Claude必须在每一轮输出当前上下文摘要，包括：
	•	当前正在调试哪个问题；
	•	已完成哪些修改；
	•	还剩下哪些环节未验证；
	2.	每次调试阶段结束后，Claude应主动记录一份 Debug 日志到 claude_workspace/debug_*.md 文件中。

⸻

✅ Claude 提示模板（可作为 Claude 调试开头提示）



⚠️ Claude 调试提示规则：
- 请不要做任何你“觉得合理”的修改，除非你已完全确认问题来源；
- 所有修改请先列出变更点列表，再执行；
- 所有修改必须在调试日志中详细记录；
- 除非显式要求，请勿修改你没有被指派的模块；
- 如需上下文摘要，请你自己补充调试流程；



⸻

✅ 总结

要求	说明
🧠 思路清晰	Claude必须以步骤推进，而非试错式猜测
🔍 修改可控	所有修改都要透明、可回滚
📜 日志明确	所有调试过程必须记录为日志，写入 claude_workspace/
⛔ 慎动核心模块	稳定运行的模块禁止无授权改动


⸻
