

🧠 Claude 前端提示词（V1.3 用户登录与注册功能）

🎯 开发目标

你将为 Flutter 项目 frontend/pocketspeak_app/ 实现完整的用户登录/注册界面，支持：
	•	邮箱 + 验证码登录
	•	Apple ID 登录（预留）
	•	登录成功后持久化用户状态
	•	登录状态判断 → 跳转逻辑
	•	所有表单交互、状态切换、错误提示

⸻

🗂 目录结构要求

请将本次功能的 UI 组件放入以下目录：

frontend/lib/pages/auth/
├── login_page.dart
├── widgets/
│   ├── email_input.dart
│   ├── code_input.dart
│   └── apple_login_button.dart


⸻

✅ 页面需求：LoginPage

🧩 页面组件结构：

组件名称	类型	功能说明
欢迎标题	Text	“欢迎使用 PocketSpeak”
邮箱输入框	TextField	限制格式为邮箱，附错误提示
验证码输入框	TextField	限制6位纯数字，附错误提示
获取验证码按钮	Button	点击后调用发送验证码接口并倒计时
登录按钮	ElevatedButton	点击后发送登录请求
Apple 登录按钮	AppleLoginButton	预留（可展示 Disabled 状态）
条款提示	RichText	“登录即代表同意服务条款与隐私政策”


⸻

🔄 逻辑要求
	•	所有输入字段应带有清晰的输入验证（如邮箱正则，验证码6位）
	•	验证码按钮应在点击后启动60秒倒计时，期间不可重复发送
	•	登录按钮点击后禁用自身，展示 loading 状态，直到登录成功或失败
	•	登录成功后将 token 保存至本地（SharedPreferences）
	•	登录后立即调用 /api/user/me 获取完整用户信息
	•	如用户没有 english_level 字段 → 跳转测评页
	•	否则跳转主聊天页面

⸻

📡 网络请求接口说明

你需要调用以下后端 API（由后端团队提供）：

发送验证码

POST /api/auth/send-code
Body: { "email": "user@example.com" }

响应成功后启动倒计时。

⸻

邮箱验证码登录

POST /api/auth/login-code
Body: {
  "email": "user@example.com",
  "code": "123456"
}

成功响应将包含：

{
  "token": "xxxxx",
  "user": {
    "user_id": "...",
    "email": "...",
    "english_level": "B1"
  }
}

⚠️ 若无 english_level 字段，则为新用户，跳转到测评页（V1.2）

⸻

获取当前用户

GET /api/user/me
Headers: Authorization: Bearer <token>

用于 App 启动时判断是否已登录。

⸻

💡 UI风格要求
	•	保持简洁、现代、亲和力设计风格
	•	按照我们前期约定的 APP 风格（参考 CLAUDE.md 中设计规范）
	•	所有颜色、字体请使用 Flutter 中统一的样式配置
	•	提示信息清晰、反馈及时，避免用户困惑

⸻

💾 本地存储建议

请使用 Flutter 插件：

import 'package:shared_preferences/shared_preferences.dart';

将 auth_token 存入本地，供后续启动时自动登录判断。

⸻

🚫 注意事项
	1.	不允许将任何后端逻辑写入前端代码（如验证码判断逻辑）
	2.	所有 API 错误需给出用户可理解的提示（如“验证码错误，请重试”）
	3.	不得直接跳转页面前确保用户状态拉取成功
	4.	不得省略动画、loading状态或按钮禁用控制

