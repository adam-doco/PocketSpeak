

🧩 一、前端 Claude 提示词

📌 任务目标：

为 PocketSpeak Flutter 前端项目新增 “点击单词弹出释义窗口” 的功能模块，支持查看中文释义、英美音标、点击发音、收藏到生词本等功能。

⸻

🛠️ 任务要求：

🔹 弹窗功能
	1.	在聊天页面的文本展示中（chat_page.dart），实现 识别可点击英文单词。
	2.	用户点击单词后，弹出 BottomSheet 弹窗 显示释义信息。
	3.	弹窗样式需美观简洁，适配深色 / 浅色模式。

🔹 弹窗内容组件
	•	单词原文（加粗大字显示）
	•	英式音标 + 发音按钮
	•	美式音标 + 发音按钮
	•	中文释义（支持多义项）
	•	加入生词本按钮（点击后调用接口）
	•	关闭按钮

🔹 API 调用
	•	请求接口：GET /api/words/lookup?word=xxx
	•	返回内容包括：释义、音标、发音音频地址
	•	播放音频支持 mp3 格式（建议使用 audioplayers 或 just_audio Flutter 包）
	•	收藏接口：POST /api/words/favorite

⸻

📁 文件结构建议：

lib/
├── pages/
│   └── chat_page.dart            # 聊天页面，添加单词点击识别逻辑
├── widgets/
│   └── word_popup_sheet.dart     # 单词释义弹窗组件
├── services/
│   └── word_service.dart         # 调用词典/发音/收藏 API


⸻

✅ 技术限制提醒：
	•	不支持 HTML 渲染，必须使用纯 Flutter UI 构建 BottomSheet
	•	单词发音播放必须支持 Android / iOS 双端播放，注意异步加载与播放控制
	•	所有 API 地址需配置在统一的 api_config.dart 中（为后续多服务兼容预留）

⸻

✅ Claude 成功判断标准：
	•	聊天页面中的任意英文单词点击可弹出释义弹窗
	•	弹窗展示正确内容（音标、中文释义、发音按钮）
	•	点击播放按钮可播放对应音标音频
	•	点击加入生词本按钮后发送收藏请求
	•	所有异常情况有清晰 UI 提示（如网络错误、无释义等）

⸻

🧩 二、后端 Claude 提示词（存放路径：backend_claude_memory/prompts/v1.5_word_lookup_api_prompt.md）

📌 任务目标：

为 PocketSpeak FastAPI 后端项目开发以下功能：
	1.	查询英文单词的音标、发音、释义等信息（整合第三方词典 API）
	2.	用户点击“加入生词本”后将该单词加入数据库
	3.	所有接口需支持用户 ID 识别（兼容 1.2 版本用户体系）

⸻

🛠️ 任务模块：

🔹 词义查询接口：GET /api/words/lookup
	•	接收参数：word=string
	•	调用第三方词典 API（优先使用 DictionaryAPI 或 Youdao）
	•	返回字段包括：
	•	单词本体
	•	英式音标 / 美式音标
	•	音标发音 mp3 链接
	•	中文释义数组
	•	解析并格式化返回 JSON

🔹 生词本收藏接口：POST /api/words/favorite
	•	Body 参数包括：
	•	user_id：字符串
	•	word：字符串
	•	将该词收藏到数据库（生词本表）
	•	同一个用户同一单词不可重复收藏

⸻

🔧 配置要求
	1.	所有外部 API 地址、Key 必须从 config/external_apis.yaml 中加载
	2.	使用 api_loader.py 动态切换第三方服务（禁止硬编码）
	3.	增加 config/ 模块的 README 注释说明结构

⸻

🧾 数据库表结构建议（如未建立）：

表名：vocab_favorites

字段	类型	描述
id	UUID	主键
user_id	string	用户 ID
word	string	单词
created_at	datetime	添加时间


⸻

✅ Claude 成功判断标准：
	•	正确调用第三方词典 API，返回标准格式 JSON
	•	发音链接可直接访问（mp3）
	•	收藏接口请求成功后写入数据库，重复收藏返回提示
	•	所有错误都有异常处理机制和日志记录

⸻
